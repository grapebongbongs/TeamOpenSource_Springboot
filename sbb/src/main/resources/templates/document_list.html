<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      th:replace="layout :: layout (~{::body})"
      th:with="content='this :: content'">

<body>
<div th:fragment="content">

    <h1 class="page-title">내가 업로드한 PDF 목록</h1>

    <!-- 상단 액션 영역 -->
    <div class="card" style="margin-bottom: 16px;">
        <div style="
            display:flex;
            justify-content:space-between;
            align-items:center;
            gap:12px;
            flex-wrap:wrap;
        ">
            <span style="color:#555; font-size:14px;">
                총 <span th:text="${#lists.size(files)}">0</span>개
            </span>

            <a th:href="@{/document/upload}" class="btn">
                ➕ 새 PDF 업로드
            </a>
        </div>
    </div>

    <!-- 목록 테이블 카드 -->
    <div class="card">
        <table class="table">
            <thead>
            <tr>
                <th>ID</th>
                <th>원본 파일명</th>
                <th>저장 파일명</th>
                <th>파일 크기 (byte)</th>
                <th>업로드 시각</th>
                <th style="width:110px; text-align:center;">액션</th>
            </tr>
            </thead>
            <tbody>
            <tr th:if="${#lists.isEmpty(files)}">
                <td colspan="6" style="text-align:center; padding:24px 0; color:#777;">
                    업로드된 PDF가 없습니다. 먼저 파일을 업로드해 주세요.
                </td>
            </tr>
            <tr th:each="file : ${files}">
                <td th:text="${file.id}"></td>
                <td th:text="${file.originalFilename}"></td>
                <td th:text="${file.storedFilename}"></td>
                <td th:text="${file.fileSize}"></td>
                <td th:text="${file.uploadedAt}"></td>
                <td style="text-align:center;">
                    <!-- 삭제 버튼 (POST + CSRF) -->
                    <form th:action="@{/document/delete/{id}(id=${file.id})}"
                          method="post"
                          style="display:inline;"
                          onsubmit="return confirm('정말 이 PDF를 삭제할까요?');">

                        <input type="hidden"
                               th:name="${_csrf.parameterName}"
                               th:value="${_csrf.token}" />

                        <button type="submit"
                                class="btn btn-outline"
                                style="padding:4px 10px; font-size:12px;">
                            🗑 삭제
                        </button>
                    </form>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

    <!-- 하단 액션 -->
    <div style="display:flex; justify-content:flex-end; margin-top: 10px;">
        <a th:href="@{/document/makeprob}" class="btn btn-outline">
            📝 문제 만들기
        </a>
    </div>

</div>
</body>
</html>
